<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.teamp.petriots.sit_approve.dao.IPst_reserveDAO">
	
	<select id="petsittercard" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
   		SELECT USER_NUM, ADDRESS, NICKNAME, PROFILE_IMG, P_S_NUM
		FROM PETSITTER_VIEW
		WHERE USER_NUM = #{user_num}
    </select>
    
    <select id="detaildata" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
      	SELECT USER_NUM, ADDRESS, ADDRDETAILS, PRICE
		FROM PETSITTER_VIEW
		WHERE USER_NUM = #{user_num}
    </select>

	<insert id="reserveapply">
		INSERT INTO RSV_APPLY(R_A_NUM, STTDATE, ENDDATE, P_R_NUM, P_S_NUM)
		VALUES(RSV_APPLYSEQ.NEXTVAL, TO_DATE('${sttdate}', 'YYYY-MM-DD'), TO_DATE('${enddate}', 'YYYY-MM-DD'), ${p_r_num}, ${p_s_num})
	</insert>
	
   
   <!-- 위탁 중 리스트 -->   
   <select id="reservenowlist" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
      SELECT SU.USER_NUM AS USER_NUM, SU.NICKNAME AS NICKNAME, PR.P_R_NUM AS P_R_NUM, SU.PROFILE_IMG AS PROFILE_IMG, PR.PET_IMG AS PET_IMG, RA.R_A_NUM AS R_A_NUM, SU.ADDRESS AS ADDRESS, PR.NAME AS PET_NAME
      FROM SIT_APPROVE SA, RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, SIGNUP SU, PST_SHIFT PS
      WHERE SA.R_C_NUM = RC.R_C_NUM
        AND RC.R_A_NUM = RA.R_A_NUM
        AND RA.P_R_NUM = PR.P_R_NUM
        AND PR.USER_NUM = SU.USER_NUM
        AND RA.P_S_NUM = PS.P_S_NUM
        AND PS.USER_NUM = #{user_num}
      MINUS
      SELECT SU.USER_NUM AS USER_NUM, SU.NICKNAME AS NICKNAME, PR.P_R_NUM AS P_R_NUM, SU.PROFILE_IMG AS PROFILE_IMG, PR.PET_IMG AS PET_IMG, RA.R_A_NUM AS R_A_NUM, SU.ADDRESS AS ADDRESS, PR.NAME AS PET_NAME
      FROM SIT_COMPLETE SC, SIT S, SIT_APPROVE SA, RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, SIGNUP SU, PST_SHIFT PS
      WHERE SC.S_NUM = S.S_NUM
        AND S.S_A_NUM = SA.S_A_NUM
        AND SA.R_C_NUM = RC.R_C_NUM
        AND RC.R_A_NUM = RA.R_A_NUM
        AND RA.P_R_NUM = PR.P_R_NUM
        AND PR.USER_NUM = SU.USER_NUM
        AND RA.P_S_NUM = PS.P_S_NUM
        AND PS.USER_NUM = #{user_num}
   </select> 
   
   <select id="reservenowdetail" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
    SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PR.USER_NUM = SU.USER_NUM
     AND PS.USER_NUM = #{user_num}
     AND RA.R_A_NUM = #{r_a_num}
   MINUS
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_COMPLETE SC, SIT S, SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SC.S_NUM = S.S_NUM
     AND S.S_A_NUM = SA.S_A_NUM
     AND SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PR.USER_NUM = SU.USER_NUM
     AND PS.USER_NUM = #{user_num}
     AND RA.R_A_NUM = #{r_a_num}
   </select>
   
   <!-- user -->
   <select id="reservenowdetail_u" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
    SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PS.USER_NUM = SU.USER_NUM
     AND RA.R_A_NUM = #{r_a_num}
   MINUS
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_COMPLETE SC, SIT S, SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SC.S_NUM = S.S_NUM
     AND S.S_A_NUM = SA.S_A_NUM
     AND SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PS.USER_NUM = SU.USER_NUM
     AND RA.R_A_NUM = #{r_a_num}
   </select>
   
   <select id="reserveapprovedetail" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PR.USER_NUM = SU.USER_NUM
     AND PS.USER_NUM = #{user_num}
     AND RA.R_A_NUM = #{r_a_num}
   MINUS
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PR.USER_NUM = SU.USER_NUM
     AND PS.USER_NUM = #{user_num}
     AND RA.R_A_NUM = #{r_a_num}
   </select>
   
   <delete id="reserveapprovecancel">
      
      DELETE
      FROM RSV_APPLY
      WHERE R_A_NUM = #{r_a_num}
      
   </delete>
   
   <insert id="reserveokay">
   INSERT INTO RSV_CONFIRM(R_C_NUM, R_A_NUM, PRICE)
   VALUES(RSV_CONFIRMSEQ.NEXTVAL, #{r_a_num}, 
   (SELECT PP.PRICE
   FROM RSV_APPLY RA, PST_SHIFT PS, PST_PROFILE PP
   WHERE RA.P_S_NUM = PS.P_S_NUM
     AND PS.P_S_NUM = PP.P_S_NUM
     AND RA.R_A_NUM = #{r_a_num}))
   </insert>
   
   <insert id="sittingcomplete1">
   INSERT INTO SIT(S_NUM, S_A_NUM, USEREND, PETSITTEREND)
   VALUES(SITSEQ.NEXTVAL
    ,(SELECT SA.S_A_NUM
    FROM SIT_APPROVE SA, RSV_CONFIRM RC, RSV_APPLY RA
    WHERE SA.R_C_NUM = RC.R_C_NUM
      AND RC.R_A_NUM = RA.R_A_NUM
      AND RA.R_A_NUM = #{r_a_num})
    , SYSDATE
    , SYSDATE )
   </insert>
   
   <insert id="sittingcomplete2">
   INSERT INTO SIT_COMPLETE(S_C_NUM, S_NUM, ACHIEVEMENT, FINALPRICE)
   VALUES(SITSEQ.NEXTVAL
    ,(SELECT S.S_NUM
    FROM SIT S, SIT_APPROVE SA, RSV_CONFIRM RC, RSV_APPLY RA
    WHERE S.S_A_NUM = SA.S_A_NUM
      AND SA.R_C_NUM = RC.R_C_NUM
      AND RC.R_A_NUM = RA.R_A_NUM
      AND RA.R_A_NUM = #{r_a_num})
    , 0
    , (SELECT PP.PRICE
   FROM RSV_APPLY RA, PST_SHIFT PS, PST_PROFILE PP
   WHERE RA.P_S_NUM = PS.P_S_NUM
     AND PS.P_S_NUM = PP.P_S_NUM
     AND RA.R_A_NUM = #{r_a_num}) )
   </insert>
   
   
   <insert id="sittingstart">
   INSERT INTO SIT_APPROVE(S_A_NUM, R_C_NUM, STTDATE)
   VALUES(SIT_APPROVESEQ.NEXTVAL
    ,(SELECT RC.R_C_NUM
    FROM  RSV_CONFIRM RC, RSV_APPLY RA
    WHERE RC.R_A_NUM = RA.R_A_NUM
      AND RA.R_A_NUM = #{r_a_num})
    , SYSDATE )
   </insert>
   
   <select id="reserveapprovedetail_u" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PS.USER_NUM = SU.USER_NUM
     AND RA.R_A_NUM = #{r_a_num}
   MINUS
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PS.USER_NUM = SU.USER_NUM
     AND RA.R_A_NUM = #{r_a_num}
   </select>
   
   <select id="reservelist" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
      SELECT SU.USER_NUM AS USER_NUM, SU.NICKNAME AS NICKNAME, PR.P_R_NUM AS P_R_NUM, SU.PROFILE_IMG AS PROFILE_IMG, PR.PET_IMG AS PET_IMG, RA.R_A_NUM AS R_A_NUM, SU.ADDRESS AS ADDRESS, PR.NAME AS PET_NAME
      FROM SIT_COMPLETE SC, SIT S, SIT_APPROVE SA, RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, SIGNUP SU, PST_SHIFT PS
      WHERE SC.S_NUM = S.S_NUM
        AND S.S_A_NUM = SA.S_A_NUM
        AND SA.R_C_NUM = RC.R_C_NUM
        AND RC.R_A_NUM = RA.R_A_NUM
        AND RA.P_R_NUM = PR.P_R_NUM
        AND PR.USER_NUM = SU.USER_NUM
        AND RA.P_S_NUM = PS.P_S_NUM
        AND PS.USER_NUM = #{user_num}
   </select>
   
   <select id="reservepastdetail" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_COMPLETE SC, SIT S, SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SC.S_NUM = S.S_NUM
     AND S.S_A_NUM = SA.S_A_NUM
     AND SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PR.USER_NUM = SU.USER_NUM
     AND PS.USER_NUM = #{user_num}
     AND RA.R_A_NUM = #{r_a_num}
   </select>


   <!-- user -->
   <select id="reservepastdetail_u" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM SIT_COMPLETE SC, SIT S, SIT_APPROVE SA,RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE SC.S_NUM = S.S_NUM
     AND S.S_A_NUM = SA.S_A_NUM
     AND SA.R_C_NUM = RC.R_C_NUM
     AND RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PS.USER_NUM = SU.USER_NUM
     AND RA.R_A_NUM = #{r_a_num}
   </select>
   
   <select id="reserveapprovelist" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
      SELECT SU.USER_NUM AS USER_NUM, SU.NICKNAME AS NICKNAME, PR.P_R_NUM AS P_R_NUM, SU.PROFILE_IMG AS PROFILE_IMG, PR.PET_IMG AS PET_IMG, RA.R_A_NUM AS R_A_NUM, SU.ADDRESS AS ADDRESS, PR.NAME AS PET_NAME
      FROM RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, SIGNUP SU, PST_SHIFT PS
      WHERE RC.R_A_NUM = RA.R_A_NUM
        AND RA.P_R_NUM = PR.P_R_NUM
        AND PR.USER_NUM = SU.USER_NUM
        AND RA.P_S_NUM = PS.P_S_NUM
        AND PS.USER_NUM = #{user_num}
      MINUS
      SELECT SU.USER_NUM AS USER_NUM, SU.NICKNAME AS NICKNAME, PR.P_R_NUM AS P_R_NUM, SU.PROFILE_IMG AS PROFILE_IMG, PR.PET_IMG AS PET_IMG, RA.R_A_NUM AS R_A_NUM, SU.ADDRESS AS ADDRESS, PR.NAME AS PET_NAME
      FROM SIT_APPROVE SA, RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, SIGNUP SU, PST_SHIFT PS
      WHERE SA.R_C_NUM = RC.R_C_NUM
        AND RC.R_A_NUM = RA.R_A_NUM
        AND RA.P_R_NUM = PR.P_R_NUM
        AND PR.USER_NUM = SU.USER_NUM
        AND RA.P_S_NUM = PS.P_S_NUM
        AND PS.USER_NUM = #{user_num}
   </select>
   
   <select id="reserverequestlist" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
      SELECT SU.USER_NUM AS USER_NUM, SU.NICKNAME AS NICKNAME, PR.P_R_NUM AS P_R_NUM, SU.PROFILE_IMG AS PROFILE_IMG, PR.PET_IMG AS PET_IMG, RA.R_A_NUM AS R_A_NUM, SU.ADDRESS AS ADDRESS, PR.NAME AS PET_NAME
      FROM  RSV_APPLY RA, PET_REGISTER PR, SIGNUP SU, PST_SHIFT PS
      WHERE RA.P_R_NUM = PR.P_R_NUM
        AND PR.USER_NUM = SU.USER_NUM
        AND RA.P_S_NUM = PS.P_S_NUM
        AND PS.USER_NUM = #{user_num}
      MINUS
      SELECT SU.USER_NUM AS USER_NUM, SU.NICKNAME AS NICKNAME, PR.P_R_NUM AS P_R_NUM, SU.PROFILE_IMG AS PROFILE_IMG, PR.PET_IMG AS PET_IMG, RA.R_A_NUM AS R_A_NUM, SU.ADDRESS AS ADDRESS, PR.NAME AS PET_NAME
      FROM RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, SIGNUP SU, PST_SHIFT PS
      WHERE RC.R_A_NUM = RA.R_A_NUM
        AND RA.P_R_NUM = PR.P_R_NUM
        AND PR.USER_NUM = SU.USER_NUM
        AND RA.P_S_NUM = PS.P_S_NUM
        AND PS.USER_NUM = #{user_num}
   </select>
   
   <select id="reserverequestdetail" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
    SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM  RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PR.USER_NUM = SU.USER_NUM
     AND PS.USER_NUM = #{user_num}
     AND RA.R_A_NUM = #{r_a_num}
   MINUS
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE  RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PR.USER_NUM = SU.USER_NUM
     AND PS.USER_NUM = #{user_num}
     AND RA.R_A_NUM = #{r_a_num}
   </select>
   
   <select id="reserverequestdetail_u" resultType="com.teamp.petriots.sit_approve.dto.Pst_reserveDTO">
    SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM  RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PS.USER_NUM = SU.USER_NUM
     AND RA.R_A_NUM = #{r_a_num}
   MINUS
   SELECT SU.NICKNAME AS "NICKNAME", SU.PROFILE_IMG AS "PROFILE_IMG", PR.NAME AS "PET_NAME", PR.PET_IMG AS "PET_IMG"
     , RA.R_A_NUM AS "R_A_NUM", TO_CHAR(RA.STTDATE, 'HH24:MI') AS "CHECKIN", TO_CHAR(RA.ENDDATE, 'HH24:MI') AS "CHECKOUT", RA.ISUDATE AS "ISUDATE"
     , SU.ADDRESS AS "ADDRESS", PR.SPEICES AS "SPEICES", PR.ILLNESS AS "ILLNESS", PR.ADDITIONAL AS "ADDITIONAL"
     , PR.DRUG AS "DRUG", TO_CHAR(RA.STTDATE, 'YYYY-MM-DD')AS "STTDATE"
   FROM RSV_CONFIRM RC, RSV_APPLY RA, PET_REGISTER PR, PST_SHIFT PS, SIGNUP SU
   WHERE  RC.R_A_NUM = RA.R_A_NUM
     AND RA.P_R_NUM = PR.P_R_NUM
     AND RA.P_S_NUM = PS.P_S_NUM
     AND PS.USER_NUM = SU.USER_NUM
     AND RA.R_A_NUM = #{r_a_num}
   </select>
   
</mapper>